---
import { links } from '@/lib/utils'
import { useId } from 'preact/compat'
import { ThemeSelector } from './ThemeSelector'
import { RegisterLink } from './user/RegisterLink'
import { AccountLink } from './user/AccountLink'
import { LoginLink } from './user/LoginLink'

interface Props {
  pathname?: string
}

const { pathname } = Astro.props

const { isAuth } = Astro.locals
---
<aside
  class='sidebar-open:right-0 -right-sidebar max-w-full overflow-y-auto mb-4 transition-[right] fixed top-0 w-sidebar min-w-fit h-full flex flex-col xl:hidden duration-300 z-[2] px-8 [scrollbar-width:thin] bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100'
>
  <header class='h-navbar min-h-navbar w-full flex items-center justify-center'>
    <label
      for='input-global-sidebar'
      class='h-fit w-full p-2 min-h-10 border transition-colors rounded-lg flex xl:hidden items-center justify-center cursor-pointer border-orange-500 text-orange-500 hover:bg-orange-50 hover:text-gray-700 touch:active:bg-orange-50 touch:active:text-gray-700 dark:hover:bg-gray-700 dark:hover:text-orange-50 dark:hover:border-orange-50 dark:touch:active:bg-gray-700 dark:touch:active:text-orange-50 dark:touch:active:border-orange-50'
    >
      Cerrar men√∫
    </label>
  </header>
  <main class='h-fit w-full flex flex-col items-center gap-2 min-h-fit'>
    {
      links.map(({ link, name, Icon }) => (
        <a
          href={link}
          class={`${link === pathname ? 'text-orange-500' : ''} hover:text-orange-500 touch:active:text-orange-500 transition-colors p-2 w-full text-center flex items-center gap-4`}
        >
          <div class='size-6 flex items-center justify-center'>
            <Icon />
          </div>
          <span class='text-nowrap'>
            {name}
          </span>
        </a>
      ))
    }
  </main>
  <div class='py-4 flex-1 w-full h-fit min-h-fit flex flex-col items-center justify-end gap-2'>
    <ThemeSelector listClass='bottom-13 right-0' />
    { !isAuth && <LoginLink class='w-full text-center' /> }
    { !isAuth && <RegisterLink class='w-full text-center' /> }
    { isAuth && <AccountLink class='w-full' /> }
  </div>
</aside>
<label
  for='input-global-sidebar'
  class='not-sidebar-open:hidden fixed h-screen w-screen z-[1] left-0 top-0 bg-black/40 xl:hidden cursor-pointer'
/>
